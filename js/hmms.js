(function(){var t;this.TimeTable=function(){function t(t){var e,n,s,i,r,o;for(this.src=t,this.tt=[],this.weekday=0,this.saturday=0,this.sunday_holiday=0,n=this.loadTimeTable(t).split(String.fromCharCode(10)),e=s=0,r=n.length;r>=0?r>s:s>r;e=r>=0?++s:--s)this.tt[e]=n[e].split(",");for(e=i=0,o=this.tt.length;o>=0?o>i:i>o;e=o>=0?++i:--i)"[平日]"===this.tt[e][0]&&(this.weekday=e+1),"[土曜]"===this.tt[e][0]&&(this.saturday=e+1),"[日曜・祝日]"===this.tt[e][0]&&(this.sunday_holiday=e+1)}return t.prototype.getRoute=function(){return this.tt[0][0]},t.prototype.getStation=function(){return this.tt[0][1]},t.prototype.getDesc=function(){return this.tt[0][2]},t.prototype.loadTimeTable=function(t){var e;return e=new XMLHttpRequest,e.open("GET",t,!1),e.send(null),e.responseText},t.prototype.hhmm=function(t,e){var n,s;return n=t.getHours(),s=t.getMinutes(),e?String(n+24)+":"+String(s+100).substring(1):String(n+100).substring(1)+":"+String(s+100).substring(1)},t.prototype.nexttime=function(t,e){var n,s,i,r,o,a,u,h,g;for(a=this.hhmm(t,e),o=new Date(t),e?(n=(t.getDay()+6)%7,u=new Date(t),u.setDate(u.getDate()-1),isHoliday(u.getFullYear(),u.getMonth()+1,u.getDate(),!0)&&(n=0)):(n=t.getDay(),isHoliday(t.getFullYear(),t.getMonth()+1,t.getDate(),!0)&&(n=0)),n>0&&6>n&&(i=this.weekday),6===n&&(i=this.saturday),0===n&&(i=this.sunday_holiday),i=h=i,g=this.tt.length;(g>=i?g>h:h>g)&&!(this.tt[i][0]>a);i=g>=i?++h:--h);return this.tt[i]&&"["!==this.tt[i][0][0]?(this.tt[i][0].substring(0,2)>"23"?(s=parseInt(this.tt[i][0].substring(0,2),10)-24,e||o.setDate(o.getDate()+1)):s=parseInt(this.tt[i][0].substring(0,2),10),r=parseInt(this.tt[i][0].substring(3,5),10),o.setHours(s,r,0,0),{time:o,str:this.tt[i]}):e?!1:(o.setDate(o.getDate()+1),o.setHours(0,0,0,0),this.nexttime(o,e))},t}(),t=function(t){var e,n,s;return e=String(Math.floor(t/36e5)),n=String(Math.floor((t-36e5*e)/6e4)+100).substring(1),s=String(Math.round((t-36e5*e-6e4*n)/1e3)+100).substring(1),e+":"+n+":"+s},this.timetest=function(){var e,n,s,i,r,o;for(i=new Date,(-60>offset||offset>60)&&alert("offset range error"),i.setMinutes(i.getMinutes()+offset%60),document.getElementById("now").innerHTML="出発時刻："+i.toLocaleString(),s=o=0;tables>=0?tables>o:o>tables;s=tables>=0?++o:--o)r=this.table[s].nexttime(i,!0),r||(r=this.table[s].nexttime(i,!1)),document.getElementById("next"+String(s+1)).innerHTML=r.str[0]+"発 "+r.str[3],document.getElementById("dir"+String(s+1)).innerHTML=r.str[2]+" "+r.str[1],e=r.time-i,e>=0&&(n=document.getElementById("dur"+String(s+1)),n.innerHTML="あと"+t(e),n.style.color=function(){switch(!1){case!(6e4>e):return"red";case!(18e4>e):return"orange";default:return"black"}}());return setTimeout(function(){return timetest()},1e3)}}).call(this);